<span style="font-size:11pt; font-weight: normal">As requested in the [DevOps task #10503 - SER_DIIA Invoice journal-DEV: Change the existing logic in creating the vendor invoice journal](https://ad365o.visualstudio.com/Planning/_workitems/edit/10503), the following changes were applied in the PerformPark and PerformPost methods:
- JSON payload with the journal invoice details is transformed so that the offset account in the invoice lines is cleared, and the GL account (which previously was stored in the offset account field) is moved to the main account field. Besides that, a new line is created, with the vendor account in the main account field and with the total amount from all the invoice lines in the Credit field.
- The modified output from the APIM methods requested the modification in the backend F&O to be applied in the service method that further processes this data and eventually creates the invoice. The modification in the backend was applied, but as it was necessary to ensure that creating and posting the journal invoices would work correctly even if the backend F&O didn't have the package with these modifications, the following approach was taken: the old service method in F&O is kept as-is, and the new method is created with the same name, just with "V2" added as a suffix to the method name. For the same purpose (ensuring backward compatibility - successful creation of the invoices if F&O doesn't have the necessary modifications), another change in the API Management policies is applied. In the inbound block of PerformPark and PerformPost policies, it is first checked whether the "V2" F&O service method exists. If it does, they process the data the new way and send it to the new (V2) service method. But if it does not, they process the payload the old way and send it to the old service method.
- As the above-described changes caused a significant increase in the overall size of these APIM methods, it was necessary to extract parts of code in the policy fragments. The full list of policy fragments includes:
  1. `SER-Doxis4-ERP-Connection-Service-Perform-Inbound1`. Used both in PerformPark and PerformPost policies and contains the first part of their inbound blocks.
  2. `SER-Doxis4-ERP-Connection-Service-Perform-Outbound1`. Used both in PerformPark and PerformPost policies and contains part of their outbound blocks.
  3. `SER-Doxis4-ERP-Connection-Service-PerformPark-Body`. 